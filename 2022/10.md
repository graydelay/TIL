# 2022-10

## 2022-10-20
### JPA: API 개발 기본 
### 엔티티 직접 사용
- 문제점
    1. 엔티티에 프레젠테이션 계층을 위한 로직이 추가됨
    2. 엔티티에 API 검증을 위한 로직이 들어간다 (ex. `@NotEmpty`)
    3. 엔티티가 변경되면 API 스팩이 변한다
    4. 컬렉션 조회의 경우 컬렉션을 그대로 반환하게 되면 API 스펙을 변경하기가 어려움. 별도의 클래스 생성으로 해결해야 한다
- **API 요청 스펙에 맞추어 별도의 DTO를 파라미터로 사용한다**
- **실무에서는 엔티티를 API 스펙에 노출해서는 안된다!!!**

### PUT vs PATCH
- PUT은 전체를 업데이트 할 때 사용하는 것이 맞음
- 부분 업데이트를 할 때는 PATCH 또는 POST를 사용하는 것이 맞다

## 2022-10-16
### 도메인 모델 패턴 vs 트랜잭션 스크립트 패턴
- 도메인 모델 패턴
    - 엔티티가 비즈니스 로직을 가지고 객체 지향의 특성을 적극 활용
    - 비즈니스 로직 대부분이 엔티티에 있음
    - 서비스 계층은 단순히 엔티티에 필요한 요청을 위임하는 역할
- 트랜잭션 스크립트 패턴
    - 엔티티에는 비즈니스 로직이 거의 없음
    - 서비스 계층에서 대부분의 비즈니스 로직을 처리하는 것

## 2022-10-12
### VSCode: launch.json
- VSCode에서 디버깅을 사용하기 위해서는 `launch.json` 파일이 필요
- Node.js 디버깅을 위한 기본파일은 아래와 같음
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "node",
      "request": "launch",
      "name": "Launch Program",
      "skipFiles": ["<node_internals>/**"],
      "program": "${workspaceFolder}\\app.js"
    }
  ]
}
```
- 위와 같이 설정한 후 Run을 실행하려하면 `package.json`에 설정된 명령어를 선택하여 실행할 수 있음
- 이후 디버깅 방식은 다른 IDE와 비슷

## 2022-10-10
### 테스트 코드 (Junit)

- 테스팅 코드에서 사용하는 Transaction은 테스트가 끝나면 모두 Rollback 된다
- 만약 테스트 이후에 Rollback이 되지 않기 원한다면 `@Rollback(value = false)` 를 사용하면 롤백 되지 않고 트랜젝션이 commit 된다

## 2022-10-06
### 다형성 쿼리
- TYPE: 조회 대상을 특정 자식으로 한정
- TREAT: 자바의 타입 캐스팅과 유사, 상속 구조에서 부모 타입을 특정 자식 타입으로 다룰 때 사용

### 엔티티 직접 사용
- JPQL에서 엔티티를 직접 사용하여 SQL에 `setParameter`하게 되면 SQL에서 해당 엔티티의 기본 키 값(id)를 사용하도록 쿼리가 변경된다
- 기본 키, 외래 키에 모두 사용 가능

## 2022-10-04
### JPQL: 경로 표현식
- .(점)을 찍어 객체 그래프를 탐색하는 것
- 상태 필드(state field): 단순히 값을 저장하기 위한 필드 (ex. m.username)
- 연관 필드(association field): 연관관계를 위한 필드
    - 단일 값 연관 필드: @ManyToOne, @OneToOne, 대상이 엔티티 (ex. m.tea)
    - 컬렉션 값 연관 필드: @OneToMany, @ManyToMany, 대상이 컬렉션 (ex. m.orders)

### 경로 표현식 특징
- 상태 필드: 경로 탐색의 끝, 탐색X
- 단일 값 연관 경로: 묵시적 내부 조인(inner join) 발생, 탐색O
- 컬렉션 값 연관 경로: 묵시적 내부 조인 발생, 탐색X
    - FROM 절에서 명시적 조인을 통해 별칭을 얻으면 별칭을 통해 탐색 가능

### 명시적 조인, 묵시적 조인
- 명시적 조인: join 키워드 직접 사용
    - `select m from Member m join m.team t`
- 묵시적 조인: 경로 표현식에 의해 묵시적으로 SQL 조인 발생(내부 조인만 가능)
    - `select m.team from Member m`